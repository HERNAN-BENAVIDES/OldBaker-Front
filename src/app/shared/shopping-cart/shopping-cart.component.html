<div class="shopping-cart-floating-container">
  <!-- Botón flotante del carrito -->
  <button
    class="cart-fab"
    (click)="toggleCart()"
    [class.open]="isOpen"
    [attr.aria-expanded]="isOpen"
    aria-label="Carrito de compras"
    title="Carrito de compras">
    <lucide-icon [img]="ShoppingCart" class="cart-icon"></lucide-icon>
    <span class="cart-badge" *ngIf="itemCount > 0">{{ itemCount }}</span>
  </button>

  <!-- Panel lateral del carrito -->
  <div class="cart-panel" *ngIf="isOpen">
    <div class="cart-header">
      <h3>
        <lucide-icon [img]="ShoppingCart" class="header-icon"></lucide-icon>
        Carrito de Compras
      </h3>
      <button class="close-btn" (click)="toggleCart()" aria-label="Cerrar carrito">
        <lucide-icon [img]="X"></lucide-icon>
      </button>
    </div>

    <div class="cart-content">
      <div *ngIf="cartItems.length === 0" class="empty-cart">
        <lucide-icon [img]="ShoppingCart" class="empty-icon"></lucide-icon>
        <p>Tu carrito está vacío</p>
        <small>Agrega productos para comenzar</small>
      </div>

      <div *ngIf="cartItems.length > 0" class="cart-items">
        <div class="cart-item" *ngFor="let item of cartItems">
          <div class="item-image" *ngIf="item.image">
            <img [src]="item.image" [alt]="item.name" />
          </div>
          <div class="item-details">
            <h4>{{ item.name }}</h4>
            <p class="item-price">{{ item.price | currency:'COP':'symbol':'1.0-0' }}</p>
            <div class="item-controls">
              <button
                class="qty-btn"
                (click)="decreaseQuantity(item)"
                [disabled]="item.quantity <= 1"
                title="Disminuir cantidad">
                <lucide-icon [img]="Minus"></lucide-icon>
              </button>
              <span class="quantity">{{ item.quantity }}</span>
              <button
                class="qty-btn"
                (click)="increaseQuantity(item)"
                title="Aumentar cantidad">
                <lucide-icon [img]="Plus"></lucide-icon>
              </button>
              <button
                class="remove-btn"
                (click)="removeItem(item.id)"
                title="Eliminar producto">
                <lucide-icon [img]="Trash2"></lucide-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="cart-footer" *ngIf="cartItems.length > 0">
      <div class="cart-total">
        <span>Total:</span>
        <strong>{{ total | currency:'COP':'symbol':'1.0-0' }}</strong>
      </div>
      <div class="cart-actions">
        <button class="btn-secondary" (click)="clearCart()">
          Vaciar
        </button>
        <button class="btn-primary" (click)="checkout()">
          Pagar
        </button>
      </div>
    </div>
  </div>

  <!-- Overlay para cerrar al hacer clic fuera -->
  <div class="cart-overlay" *ngIf="isOpen" (click)="toggleCart()"></div>
</div>

